{"metadata":{"modules":{"imports":[],"exports":{"exported":[],"specifiers":[]}},"usedHelpers":[]},"ignored":false,"code":"Meteor.methods({\n  getChatId: function (user1Id, user2Id) {\n    // find a chat that has two users that match current user id\n    // and the requested user id\n    var filter = { $or: [{ user1Id: Meteor.userId(), user2Id: user2Id }, { user2Id: Meteor.userId(), user1Id: user2Id }] };\n    var chat = Chats.findOne(filter);\n    if (!chat) {\n      // no chat matching the filter - need to insert a new one\n      var chatId = Chats.insert({ user1Id: user1Id, user2Id: user2Id });\n      return chatId;\n    }\n    // there is a chat going already - use that.\n    return chat._id;\n  },\n  // adding new messages\n  addMessages: function (chatId) {\n    console.log(\"addMessages method running!\");\n    if (!this.userId) {\n      // we have a user\n      return; // give up\n    } else {\n        var chat = Chats.findOne({ _id: chatId });\n        if (chat) {\n          return chat.messages;\n        }\n      }\n  },\n  //update messages\n  update: function (chatId, chat) {\n    console.log(\"update method \");\n    Chats.update(chatId, chat);\n  }\n});","ast":null,"map":{"version":3,"sources":["/share/main.js"],"names":[],"mappings":"AAAA,MAAM,CAAC,OAAO,CAAC;AACb,WAAS,EAAC,UAAS,OAAO,EAAE,OAAO,EAAC;;;AAGlC,QAAI,MAAM,GAAG,EAAC,GAAG,EAAC,CACR,EAAC,OAAO,EAAC,MAAM,CAAC,MAAM,EAAE,EAAE,OAAO,EAAC,OAAO,EAAC,EAC1C,EAAC,OAAO,EAAC,MAAM,CAAC,MAAM,EAAE,EAAE,OAAO,EAAC,OAAO,EAAC,CACzC,EAAC,CAAC;AACb,QAAI,IAAI,GAAG,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;AACjC,QAAI,CAAC,IAAI,EAAC;;AACR,UAAI,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC,EAAC,OAAO,EAAC,OAAO,EAAE,OAAO,EAAC,OAAO,EAAC,CAAC,CAAC;AAC9D,aAAO,MAAM,CAAC;KACf;;AAEC,WAAO,IAAI,CAAC,GAAG,CAAC;GACnB;;AAED,aAAW,EAAC,UAAS,MAAM,EAAC;AAC1B,WAAO,CAAC,GAAG,CAAC,6BAA6B,CAAC,CAAC;AAC3C,QAAG,CAAC,IAAI,CAAC,MAAM,EAAC;;AACb,aAAO;KACT,MACG;AACF,YAAI,IAAI,GAAG,KAAK,CAAC,OAAO,CAAC,EAAC,GAAG,EAAC,MAAM,EAAC,CAAC,CAAC;AACvC,YAAG,IAAI,EAAC;AACN,iBAAO,IAAI,CAAC,QAAQ,CAAC;SACtB;OACF;GACF;;AAED,QAAM,EAAC,UAAS,MAAM,EAAE,IAAI,EAAC;AAC3B,WAAO,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC;AAC9B,SAAK,CAAC,MAAM,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;GAC5B;CACF,CAAC,CAAA","file":"/share/main.js.map","sourcesContent":["Meteor.methods({ \r\n  getChatId:function(user1Id, user2Id){\r\n    // find a chat that has two users that match current user id\r\n    // and the requested user id\r\n    var filter = {$or:[\r\n              {user1Id:Meteor.userId(), user2Id:user2Id}, \r\n              {user2Id:Meteor.userId(), user1Id:user2Id}\r\n              ]};\r\n    var chat = Chats.findOne(filter);\r\n    if (!chat){// no chat matching the filter - need to insert a new one\r\n      var chatId = Chats.insert({user1Id:user1Id, user2Id:user2Id});\r\n      return chatId;\r\n    }\r\n    // there is a chat going already - use that. \r\n      return chat._id;\r\n  },\r\n  // adding new messages\r\n  addMessages:function(chatId){\r\n    console.log(\"addMessages method running!\");\r\n    if(!this.userId){ // we have a user\r\n       return; // give up\r\n    }\r\n    else{\r\n      var chat = Chats.findOne({_id:chatId});\r\n      if(chat){\r\n        return chat.messages;\r\n      }\r\n    }\r\n  },\r\n  //update messages\r\n  update:function(chatId, chat){\r\n    console.log(\"update method \");\r\n    Chats.update(chatId, chat);\r\n  }\r\n})"]},"hash":"fd9f79c3d430338b23fdb693ad2ae7e4945915b3"}
